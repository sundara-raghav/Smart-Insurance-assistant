@page
@model SmartInsuranceWeb.Pages.Admin.DashboardModel
@{
    ViewData["Title"] = "Admin Dashboard";
}

<div class="container mt-4">
    <h2>Admin Dashboard</h2>
    <p class="text-muted">Welcome, @HttpContext.Session.GetString("UserName")!</p>
    <hr />

    <div class="row">
        <div class="col-md-3">
            <div class="card text-white bg-info mb-3">
                <div class="card-body">
                    <h5 class="card-title">Total Users</h5>
                    <p class="card-text display-4">@Model.TotalUsers</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-white bg-primary mb-3">
                <div class="card-body">
                    <h5 class="card-title">Total Policies</h5>
                    <p class="card-text display-4">@Model.TotalPolicies</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-white bg-warning mb-3">
                <div class="card-body">
                    <h5 class="card-title">Pending Claims</h5>
                    <p class="card-text display-4">@Model.PendingClaims</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-white bg-success mb-3">
                <div class="card-body">
                    <h5 class="card-title">Total Purchases</h5>
                    <p class="card-text display-4">@Model.TotalPurchases</p>
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-md-6">
            <h4>Claim Statistics</h4>
            <table class="table table-bordered">
                <tr>
                    <th>Total Claims</th>
                    <td>@Model.ClaimStats["Total"]</td>
                </tr>
                <tr>
                    <th>Pending</th>
                    <td class="text-warning">@Model.ClaimStats["Pending"]</td>
                </tr>
                <tr>
                    <th>Approved</th>
                    <td class="text-success">@Model.ClaimStats["Approved"]</td>
                </tr>
                <tr>
                    <th>Rejected</th>
                    <td class="text-danger">@Model.ClaimStats["Rejected"]</td>
                </tr>
            </table>
        </div>

        <div class="col-md-6">
            <h4>Quick Actions</h4>
            <div class="list-group">
                <a asp-page="/Admin/ManagePolicies" class="list-group-item list-group-item-action">
                    üìã Manage Policies
                </a>
                <a asp-page="/Admin/ManageClaims" class="list-group-item list-group-item-action">
                    ‚öñÔ∏è Review Claims
                </a>
                <a asp-page="/Admin/ManageUsers" class="list-group-item list-group-item-action">
                    üë• Manage Users
                </a>
                <a asp-page="/Admin/Reports" class="list-group-item list-group-item-action">
                    üìä View Reports
                </a>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col-md-12">
            <h4>Recent Claims Requiring Attention</h4>
            @if (Model.RecentPendingClaims.Any())
            {
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Claim ID</th>
                            <th>User</th>
                            <th>Policy</th>
                            <th>Amount</th>
                            <th>Filed Date</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var claim in Model.RecentPendingClaims.Take(5))
                        {
                            <tr>
                                <td>#@claim.Id</td>
                                <td>@Model.GetUserName(claim.UserId)</td>
                                <td>@Model.GetPolicyName(claim.PolicyId)</td>
                                <td>$@claim.ClaimAmount</td>
                                <td>@claim.FiledDate.ToShortDateString()</td>
                                <td>
                                    <a asp-page="/Admin/ManageClaims" class="btn btn-sm btn-primary">Review</a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            }
            else
            {
                <p class="text-muted">No pending claims at the moment.</p>
            }
        </div>
    </div>
</div>
